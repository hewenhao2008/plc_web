<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="<?php echo STATICS_URL; ?>temp/img/logo.png"/>
    <title>云集监控系统</title>
    <link href="<?php echo STATICS_URL; ?>temp/css/bootstrap.css" rel="stylesheet">
    <link rel="stylesheet" href="<?php echo STATICS_URL; ?>temp/css/mmss.css"/>
    <link rel="stylesheet" href="<?php echo STATICS_URL; ?>temp/css/font-awesome.min.css"/>
    <!--[if lt IE 9]>
    <script src="<?php echo STATICS_URL; ?>temp/js/html5shiv.min.js"></script>
    <script src="<?php echo STATICS_URL; ?>temp/js/respond.min.js"></script>
    <![endif]-->
    <style>

    </style>
</head>
<body>
<header>
    <div class="container-fluid navbar-fixed-top bg-primary">
        <ul class="nav navbar-nav  left">
            <li class="text-white h4">
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="glyphicon glyphicon-leaf"></span>&nbsp;&nbsp;<b>工业温控监控系统</b>
            </li>
        </ul>
        <ul class="nav navbar-nav nav-pills right ">
            <li class="bg-warning ">
                <a href="#"><span class="glyphicon glyphicon-tasks"></span><span class="badge">1</span></a>
            </li>
            <li class="bg-success">
                <a href="#"><span class="glyphicon glyphicon-envelope"></span><span class="badge">2</span></a>
            </li>
            <li class="bg-danger">
                <a href="#"><span class="glyphicon glyphicon-bell"></span></a>
            </li>
            <li class="bg-info dropdown">
                <a class="dropdown-toggle" href="#" data-toggle="dropdown">
                    <span class="glyphicon glyphicon-user"></span>&nbsp;<span>系统管理员</span><span class="caret"></span>
                </a>
                <ul class="dropdown-menu dropdown-menu-right">
                    <li class="text-center"><a href="#"><span class="text-primary">账号设置</span></a></li>
                    <li class="text-center"><a href="#"><span class="text-primary">消息设置</span></a></li>
                    <li class="text-center"><a href="#"><span class="text-primary">帮助中心</span></a></li>
                    <li class="divider"><a href="#"></a></li>
                    <li class="text-center"><a href="login.html"><span class="text-primary">退出</span></a></li>
                </ul>
            </li>
        </ul>
    </div>
</header>

<section >
    <div class="container-fluid">
        <div class="row ">
            <!--左侧导航开始-->
            <div class="col-xs-2 bg-blue">
                <br/>
                <div class="panel-group sidebar-menu" id="accordion" aria-multiselectable="true">
                    <div class="panel panel-default menu-first menu-first-active">
                        <a data-parent="#accordion" href="<?php echo base_url();?>index.php/Yunji/platform" aria-expanded="true"
                           aria-controls="collapseOne">
                            <i class="icon-home icon-large"></i> 实时数据
                        </a>
                    </div>
                    <div class="panel panel-default menu-first">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true"
                           aria-controls="collapseOne">
                            <i class="icon-user-md icon-large"></i> 历史数据</a>
                        </a>

                        <div id="collapseOne" class="panel-collapse collapse " >
                            <ul class="nav nav-list menu-second">
                                <!--                                <li><a href="--><?php //echo base_url();?><!--admin.php/Temperature/p1"><i class="icon-user"></i> 历史报表</a></li>-->
                                <li><a href="<?php echo base_url();?>index.php/Yunji/p2"><i class="icon-edit"></i> 历史曲线</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="panel panel-default menu-first">
                        <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo"
                           aria-expanded="false" aria-controls="collapseTwo">
                            <i class="icon-book icon-large"></i> 报警数据</a>
                        </a>
                        <div id="collapseTwo" class="panel-collapse collapse">
                            <ul class="nav nav-list menu-second">
                                <li><a href="<?php echo base_url();?>index.php/Yunji/p6"><i class="icon-user"></i> 最新报警</a></li>
                                <li><a href="<?php echo base_url();?>index.php/Yunji/p5"><i class="icon-edit"></i> 历史报警</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="panel panel-default menu-first">
                        <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseThree"
                           aria-expanded="false" aria-controls="collapseThree">
                            <i class="icon-book icon-large"></i> 系统信息</a>
                        </a>

                        <div id="collapseThree" class="panel-collapse collapse">
                            <ul class="nav nav-list menu-second">
                                <li><a href="<?php echo base_url();?>index.php/Yunji/p7"><i class="icon-user"></i> 站信息管理</a></li>
                                <li><a href="<?php echo base_url();?>index.php/Yunji/p9"><i class="icon-edit"></i> PLC 信息</a></li>
                                <li><a href="<?php echo base_url();?>index.php/Yunji/p10"><i class="icon-edit"></i> 变量组信息</a></li>
                                <li><a href="<?php echo base_url();?>index.php/Yunji/p11"><i class="icon-edit"></i> 变量参数</a></li>
                                <li><a href="<?php echo base_url();?>index.php/Yunji/p101"><i class="icon-user"></i> 历史曲线组</a></li>
                                <li><a href="<?php echo base_url();?>index.php/Yunji/p102"><i class="icon-user"></i> 曲线组管理参数</a></li>
                                <li><a href="<?php echo base_url();?>index.php/Yunji/p103"><i class="icon-edit"></i> 报警参数编辑</a></li>
                            </ul>
                        </div>
                    </div>

                    <div class="panel panel-default menu-first">
                        <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseFour"
                           aria-expanded="false" aria-controls="collapseThree">
                            <i class="icon-book icon-large"></i> 参数管理</a>
                        </a>

                        <div id="collapseFour" class="panel-collapse collapse">
                            <ul class="nav nav-list menu-second">
                                <li><a href="<?php echo base_url();?>index.php/Yunji/p104"><i class="icon-user"></i> 工艺参数</a></li>
                                <li><a href="<?php echo base_url();?>index.php/Yunji/p105"><i class="icon-user"></i> 参数修改</a></li>
                            </ul>
                        </div>


                    </div>
                </div>
            </div>
            <!--左侧导航结束-->
            <!----------------------------------------------------------------------------------------------------->
            <!--右侧内容开始-->
            <div class="col-xs-10">
                <br/>
                <ol class="breadcrumb">
                    <li><a href="index.html"><span class="glyphicon glyphicon-home"></span>&nbsp;后台首页</a></li>
                    <li class="active">系统管理 -历史报表</li>
                </ol>
                <div class="input-group line left">

                </div>
                <select name="snaddr" style="padding-right:10px;float:left;height:35px;margin-right:20px;" id="sele" v-model='selectData' >
                    <option v-for="name in machine_name" v-bind:value="name.sn_code">{{name.nachine_name}}</option>

                </select>
                <select class="form-control line left" id="rangeTime">
                    <option value="1">1分钟</option>
                    <option value="10">10分钟</option>
                    <option value="20">20分钟</option>
                    <option value="30">30分钟</option>
                    <option value="60">60分钟</option>

                </select>
                <input style="float:left;margin-right:10px;" class="btn btn-primary" type="button" value="搜索" v-on:click="test()">
<!--                <a href="#" class=" btn btn-primary"><span class="glyphicon glyphicon-search"></span></a>-->

<!--                <a href="#" class=" btn btn-primary "><span class="glyphicon glyphicon-download"></span></a>-->
<!--                <input style="float:left;margin-right:10px;" class="btn btn-primary" type="button"  value="导出excel" onclick="submitExport()" >-->
                <br/><br/>
                <table class="table table-bordered table-striped text-center bg-info">
                    <thead >
                    <tr class="info">
                        <th class="text-center">序号</th>
                        <th class="text-center">区域</th>
                        <th class="text-center">设备</th>
                        <th class="text-center">温度</th>
                        <th class="text-center">湿度</th>
                        <th class="text-center">时间</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr v-for="(item, index) in data_info">
                        <td>{{index+1}}</td>
                        <td>{{item.area_name}}</td>
                        <td>{{item.nachine_name}}</td>
                        <td>{{item.temp}}</td>
                        <td>{{item.humi}}</td>
                        <td>{{item.time}}</td>
                    </tr>
                    </tbody>
                </table>
                <ul class="pagination right">
                    <li class="disabled"><a href="#" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
                    </li>
                    <li class="active"><a href="#">1 <span class="sr-only">(current)</span></a></li>
                    <li><a href="#">2</a></li>
                    <li><a href="#">3</a></li>
                    <li><a href="#">4</a></li>
                    <li><a href="#">5</a></li>
                    <li><a href="#" aria-label="Next"><span aria-hidden="true">&raquo;</span></a></li>
                </ul>
            </div>
            <!--右侧内容结束-->
        </div>
    </div>
</section>

<footer class="bg-primary navbar-fixed-bottom">
    <p class="text-center text-white">版权所有&copy;内蒙古博悦信息技术有限公司</p>
</footer>

<script src="<?php echo STATICS_URL; ?>temp/js/jquery-1.11.3.js"></script>
<script src="<?php echo STATICS_URL; ?>temp/js/bootstrap.js"></script>
<script>
    /*Bootlint工具用于对页面中的HTML标签以及Bootstrapclass的使用进行检测*/
    //    (function () {
    //        var s = document.createElement("script");
    //        s.onload = function () {
    //            bootlint.showLintReportForCurrentDocument([]);
    //        };
    //        s.src = "js/bootlint.js";
    //        document.body.appendChild(s)
    //    })();

    //    添加编辑模态框
    $('#add').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget) // Button that triggered the modal
        var recipient = button.data('whatever') // Extract info from data-* attributes
        // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
        // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
        var modal = $(this)
        modal.find('.modal-title').text('' + recipient)
        modal.find('.modal-body input').val(recipient)
    })


    function submitExport() {
console.log(<?php echo $data_info;?>.data);
        $.ajax({
            type: "post",
            url: "<?php echo base_url();?>admin.php/Temperature/export_exl",
            data:{
                dataResult:<?php echo $data_info;?>.data
            },
            async: true,
            success: function(data) {
                var result = $.parseJSON(data);
                console.log(result.data);
            }
        })
    }




</script>
</body>

<script src="https://unpkg.com/vue"></script>
<script>
    //自动加载列表内容
    var vm = new Vue({
        el: '.col-xs-10',
        data: {
            data_info:<?php echo $data_info;?>.data,
            machine_name:<?php echo $machine_name;?>,
        selectData:<?php echo $machine_name;?>[0].sn_code
    },
        methods:{
        test:function () {
//            console.log(this.selectData)
            var a3=document.getElementById("sele").value;
            var case1 = $("#rangeTime").find("option:selected").val();
            var case1=parseInt(case1);
            $.ajax({
                type: "post",
                url: "<?php echo base_url();?>admin.php/Temperature/p11",
                data:{
                    sn_code:a3,
                    case:case1
//                    startTime:a4,
//                    endTime:a5
                },
                async: true,
                success: function(data) {
                    var result = $.parseJSON(data);
                    console.log(result.data);
                    temp=new Array();
                    for(i=0;i<result.data.length;i=i+case1){
                        temp.push(result.data[i])
                    }
                    vm.data_info=temp
                }
            })
        }
    }
    });

</script>
</html>